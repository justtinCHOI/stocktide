import{B as ct,j as I}from"./index-BYRxBMX6.js";import{h as In,b as H}from"./vendor-BJTqHD0O.js";import{d as W}from"./styled-components.browser.esm-Ds5_C6nt.js";import"./utils-CJA6l5lt.js";var se={exports:{}},Q={},ut;function Nn(){return ut||(ut=1,window.crypto&&window.crypto.getRandomValues?Q.randomBytes=function(s){var e=new Uint8Array(s);return window.crypto.getRandomValues(e),e}:Q.randomBytes=function(s){for(var e=new Array(s),t=0;t<s;t++)e[t]=Math.floor(Math.random()*256);return e}),Q}var oe,ht;function V(){if(ht)return oe;ht=1;var s=Nn(),e="abcdefghijklmnopqrstuvwxyz012345";return oe={string:function(t){for(var n=e.length,r=s.randomBytes(t),i=[],o=0;o<t;o++)i.push(e.substr(r[o]%n,1));return i.join("")},number:function(t){return Math.floor(Math.random()*t)},numberString:function(t){var n=(""+(t-1)).length,r=new Array(n+1).join("0");return(r+this.number(t)).slice(-n)}},oe}var lt;function F(){return lt||(lt=1,function(s){var e=V(),t={},n=!1,r=window.chrome&&window.chrome.app&&window.chrome.app.runtime;s.exports={attachEvent:function(o,a){typeof window.addEventListener<"u"?window.addEventListener(o,a,!1):window.document&&window.attachEvent&&(window.document.attachEvent("on"+o,a),window.attachEvent("on"+o,a))},detachEvent:function(o,a){typeof window.addEventListener<"u"?window.removeEventListener(o,a,!1):window.document&&window.detachEvent&&(window.document.detachEvent("on"+o,a),window.detachEvent("on"+o,a))},unloadAdd:function(o){if(r)return null;var a=e.string(8);return t[a]=o,n&&setTimeout(this.triggerUnloadCallbacks,0),a},unloadDel:function(o){o in t&&delete t[o]},triggerUnloadCallbacks:function(){for(var o in t)t[o](),delete t[o]}};var i=function(){n||(n=!0,s.exports.triggerUnloadCallbacks())};r||s.exports.attachEvent("unload",i)}(se)),se.exports}var ae,dt;function qn(){return dt||(dt=1,ae=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}),ae}var Z={},ft;function jn(){if(ft)return Z;ft=1;var s=Object.prototype.hasOwnProperty,e;function t(o){try{return decodeURIComponent(o.replace(/\+/g," "))}catch{return null}}function n(o){try{return encodeURIComponent(o)}catch{return null}}function r(o){for(var a=/([^=?#&]+)=?([^&]*)/g,c={},h;h=a.exec(o);){var u=t(h[1]),f=t(h[2]);u===null||f===null||u in c||(c[u]=f)}return c}function i(o,a){a=a||"";var c=[],h,u;typeof a!="string"&&(a="?");for(u in o)if(s.call(o,u)){if(h=o[u],!h&&(h===null||h===e||isNaN(h))&&(h=""),u=n(u),h=n(h),u===null||h===null)continue;c.push(u+"="+h)}return c.length?a+c.join("&"):""}return Z.stringify=i,Z.parse=r,Z}var ce,pt;function wn(){if(pt)return ce;pt=1;var s=qn(),e=jn(),t=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,n=/[\n\r\t]/g,r=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,i=/:\d+$/,o=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,a=/^[a-zA-Z]:/;function c(p){return(p||"").toString().replace(t,"")}var h=[["#","hash"],["?","query"],function(b,l){return v(l.protocol)?b.replace(/\\/g,"/"):b},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],u={hash:1,query:1};function f(p){var b;typeof window<"u"||typeof window<"u"?b=window:typeof self<"u"?b=self:b={};var l=b.location||{};p=p||l;var m={},E=typeof p,g;if(p.protocol==="blob:")m=new x(unescape(p.pathname),{});else if(E==="string"){m=new x(p,{});for(g in u)delete m[g]}else if(E==="object"){for(g in p)g in u||(m[g]=p[g]);m.slashes===void 0&&(m.slashes=r.test(p.href))}return m}function v(p){return p==="file:"||p==="ftp:"||p==="http:"||p==="https:"||p==="ws:"||p==="wss:"}function _(p,b){p=c(p),p=p.replace(n,""),b=b||{};var l=o.exec(p),m=l[1]?l[1].toLowerCase():"",E=!!l[2],g=!!l[3],d=0,w;return E?g?(w=l[2]+l[3]+l[4],d=l[2].length+l[3].length):(w=l[2]+l[4],d=l[2].length):g?(w=l[3]+l[4],d=l[3].length):w=l[4],m==="file:"?d>=2&&(w=w.slice(2)):v(m)?w=l[4]:m?E&&(w=w.slice(2)):d>=2&&v(b.protocol)&&(w=l[4]),{protocol:m,slashes:E||v(m),slashesCount:d,rest:w}}function C(p,b){if(p==="")return b;for(var l=(b||"/").split("/").slice(0,-1).concat(p.split("/")),m=l.length,E=l[m-1],g=!1,d=0;m--;)l[m]==="."?l.splice(m,1):l[m]===".."?(l.splice(m,1),d++):d&&(m===0&&(g=!0),l.splice(m,1),d--);return g&&l.unshift(""),(E==="."||E==="..")&&l.push(""),l.join("/")}function x(p,b,l){if(p=c(p),p=p.replace(n,""),!(this instanceof x))return new x(p,b,l);var m,E,g,d,w,S,k=h.slice(),N=typeof b,y=this,B=0;for(N!=="object"&&N!=="string"&&(l=b,b=null),l&&typeof l!="function"&&(l=e.parse),b=f(b),E=_(p||"",b),m=!E.protocol&&!E.slashes,y.slashes=E.slashes||m&&b.slashes,y.protocol=E.protocol||b.protocol||"",p=E.rest,(E.protocol==="file:"&&(E.slashesCount!==2||a.test(p))||!E.slashes&&(E.protocol||E.slashesCount<2||!v(y.protocol)))&&(k[3]=[/(.*)/,"pathname"]);B<k.length;B++){if(d=k[B],typeof d=="function"){p=d(p,y);continue}g=d[0],S=d[1],g!==g?y[S]=p:typeof g=="string"?(w=g==="@"?p.lastIndexOf(g):p.indexOf(g),~w&&(typeof d[2]=="number"?(y[S]=p.slice(0,w),p=p.slice(w+d[2])):(y[S]=p.slice(w),p=p.slice(0,w)))):(w=g.exec(p))&&(y[S]=w[1],p=p.slice(0,w.index)),y[S]=y[S]||m&&d[3]&&b[S]||"",d[4]&&(y[S]=y[S].toLowerCase())}l&&(y.query=l(y.query)),m&&b.slashes&&y.pathname.charAt(0)!=="/"&&(y.pathname!==""||b.pathname!=="")&&(y.pathname=C(y.pathname,b.pathname)),y.pathname.charAt(0)!=="/"&&v(y.protocol)&&(y.pathname="/"+y.pathname),s(y.port,y.protocol)||(y.host=y.hostname,y.port=""),y.username=y.password="",y.auth&&(w=y.auth.indexOf(":"),~w?(y.username=y.auth.slice(0,w),y.username=encodeURIComponent(decodeURIComponent(y.username)),y.password=y.auth.slice(w+1),y.password=encodeURIComponent(decodeURIComponent(y.password))):y.username=encodeURIComponent(decodeURIComponent(y.auth)),y.auth=y.password?y.username+":"+y.password:y.username),y.origin=y.protocol!=="file:"&&v(y.protocol)&&y.host?y.protocol+"//"+y.host:"null",y.href=y.toString()}function R(p,b,l){var m=this;switch(p){case"query":typeof b=="string"&&b.length&&(b=(l||e.parse)(b)),m[p]=b;break;case"port":m[p]=b,s(b,m.protocol)?b&&(m.host=m.hostname+":"+b):(m.host=m.hostname,m[p]="");break;case"hostname":m[p]=b,m.port&&(b+=":"+m.port),m.host=b;break;case"host":m[p]=b,i.test(b)?(b=b.split(":"),m.port=b.pop(),m.hostname=b.join(":")):(m.hostname=b,m.port="");break;case"protocol":m.protocol=b.toLowerCase(),m.slashes=!l;break;case"pathname":case"hash":if(b){var E=p==="pathname"?"/":"#";m[p]=b.charAt(0)!==E?E+b:b}else m[p]=b;break;case"username":case"password":m[p]=encodeURIComponent(b);break;case"auth":var g=b.indexOf(":");~g?(m.username=b.slice(0,g),m.username=encodeURIComponent(decodeURIComponent(m.username)),m.password=b.slice(g+1),m.password=encodeURIComponent(decodeURIComponent(m.password))):m.username=encodeURIComponent(decodeURIComponent(b))}for(var d=0;d<h.length;d++){var w=h[d];w[4]&&(m[w[1]]=m[w[1]].toLowerCase())}return m.auth=m.password?m.username+":"+m.password:m.username,m.origin=m.protocol!=="file:"&&v(m.protocol)&&m.host?m.protocol+"//"+m.host:"null",m.href=m.toString(),m}function O(p){(!p||typeof p!="function")&&(p=e.stringify);var b,l=this,m=l.host,E=l.protocol;E&&E.charAt(E.length-1)!==":"&&(E+=":");var g=E+(l.protocol&&l.slashes||v(l.protocol)?"//":"");return l.username?(g+=l.username,l.password&&(g+=":"+l.password),g+="@"):l.password?(g+=":"+l.password,g+="@"):l.protocol!=="file:"&&v(l.protocol)&&!m&&l.pathname!=="/"&&(g+="@"),(m[m.length-1]===":"||i.test(l.hostname)&&!l.port)&&(m+=":"),g+=m+l.pathname,b=typeof l.query=="object"?p(l.query):l.query,b&&(g+=b.charAt(0)!=="?"?"?"+b:b),l.hash&&(g+=l.hash),g}return x.prototype={set:R,toString:O},x.extractProtocol=_,x.location=f,x.trimLeft=c,x.qs=e,ce=x,ce}var ue,mt;function L(){if(mt)return ue;mt=1;var s=wn();return ue={getOrigin:function(e){if(!e)return null;var t=new s(e);if(t.protocol==="file:")return null;var n=t.port;return n||(n=t.protocol==="https:"?"443":"80"),t.protocol+"//"+t.hostname+":"+n},isOriginEqual:function(e,t){var n=this.getOrigin(e)===this.getOrigin(t);return n},isSchemeEqual:function(e,t){return e.split(":")[0]===t.split(":")[0]},addPath:function(e,t){var n=e.split("?");return n[0]+t+(n[1]?"?"+n[1]:"")},addQuery:function(e,t){return e+(e.indexOf("?")===-1?"?"+t:"&"+t)},isLoopbackAddr:function(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^\[::1\]$/.test(e)}},ue}var Y={exports:{}},vt;function T(){return vt||(vt=1,typeof Object.create=="function"?Y.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Y.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),Y.exports}var he={},le,gt;function yn(){if(gt)return le;gt=1;function s(){this._listeners={}}return s.prototype.addEventListener=function(e,t){e in this._listeners||(this._listeners[e]=[]);var n=this._listeners[e];n.indexOf(t)===-1&&(n=n.concat([t])),this._listeners[e]=n},s.prototype.removeEventListener=function(e,t){var n=this._listeners[e];if(n){var r=n.indexOf(t);if(r!==-1){n.length>1?this._listeners[e]=n.slice(0,r).concat(n.slice(r+1)):delete this._listeners[e];return}}},s.prototype.dispatchEvent=function(){var e=arguments[0],t=e.type,n=arguments.length===1?[e]:Array.apply(null,arguments);if(this["on"+t]&&this["on"+t].apply(this,n),t in this._listeners)for(var r=this._listeners[t],i=0;i<r.length;i++)r[i].apply(this,n)},le=s,le}var bt;function A(){if(bt)return he;bt=1;var s=T(),e=yn();function t(){e.call(this)}return s(t,e),t.prototype.removeAllListeners=function(n){n?delete this._listeners[n]:this._listeners={}},t.prototype.once=function(n,r){var i=this,o=!1;function a(){i.removeListener(n,a),o||(o=!0,r.apply(this,arguments))}this.on(n,a)},t.prototype.emit=function(){var n=arguments[0],r=this._listeners[n];if(r){for(var i=arguments.length,o=new Array(i-1),a=1;a<i;a++)o[a-1]=arguments[a];for(var c=0;c<r.length;c++)r[c].apply(this,o)}},t.prototype.on=t.prototype.addListener=e.prototype.addEventListener,t.prototype.removeListener=e.prototype.removeEventListener,he.EventEmitter=t,he}var ee={exports:{}},wt;function An(){if(wt)return ee.exports;wt=1;var s=window.WebSocket||window.MozWebSocket;return s?ee.exports=function(t){return new s(t)}:ee.exports=void 0,ee.exports}var de,yt;function Un(){if(yt)return de;yt=1;var s=F(),e=L(),t=T(),n=A().EventEmitter,r=An(),i=function(){};function o(a,c,h){if(!o.enabled())throw new Error("Transport created when disabled");n.call(this);var u=this,f=e.addPath(a,"/websocket");f.slice(0,5)==="https"?f="wss"+f.slice(5):f="ws"+f.slice(4),this.url=f,this.ws=new r(this.url,[],h),this.ws.onmessage=function(v){i("message event",v.data),u.emit("message",v.data)},this.unloadRef=s.unloadAdd(function(){u.ws.close()}),this.ws.onclose=function(v){i("close event",v.code,v.reason),u.emit("close",v.code,v.reason),u._cleanup()},this.ws.onerror=function(v){u.emit("close",1006,"WebSocket connection broken"),u._cleanup()}}return t(o,n),o.prototype.send=function(a){var c="["+a+"]";this.ws.send(c)},o.prototype.close=function(){var a=this.ws;this._cleanup(),a&&a.close()},o.prototype._cleanup=function(){var a=this.ws;a&&(a.onmessage=a.onclose=a.onerror=null),s.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},o.enabled=function(){return!!r},o.transportName="websocket",o.roundTrips=2,de=o,de}var fe,_t;function Ln(){if(_t)return fe;_t=1;var s=T(),e=A().EventEmitter,t=function(){};function n(r,i){e.call(this),this.sendBuffer=[],this.sender=i,this.url=r}return s(n,e),n.prototype.send=function(r){this.sendBuffer.push(r),this.sendStop||this.sendSchedule()},n.prototype.sendScheduleWait=function(){var r=this,i;this.sendStop=function(){r.sendStop=null,clearTimeout(i)},i=setTimeout(function(){r.sendStop=null,r.sendSchedule()},25)},n.prototype.sendSchedule=function(){t("sendSchedule",this.sendBuffer.length);var r=this;if(this.sendBuffer.length>0){var i="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,i,function(o){r.sendStop=null,o?(r.emit("close",o.code||1006,"Sending error: "+o),r.close()):r.sendScheduleWait()}),this.sendBuffer=[]}},n.prototype._cleanup=function(){this.removeAllListeners()},n.prototype.close=function(){this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},fe=n,fe}var pe,Et;function Hn(){if(Et)return pe;Et=1;var s=T(),e=A().EventEmitter,t=function(){};function n(r,i,o){e.call(this),this.Receiver=r,this.receiveUrl=i,this.AjaxObject=o,this._scheduleReceiver()}return s(n,e),n.prototype._scheduleReceiver=function(){var r=this,i=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);i.on("message",function(o){r.emit("message",o)}),i.once("close",function(o,a){t("close",o,a,r.pollIsClosing),r.poll=i=null,r.pollIsClosing||(a==="network"?r._scheduleReceiver():(r.emit("close",o||1006,a),r.removeAllListeners()))})},n.prototype.abort=function(){this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},pe=n,pe}var me,St;function _n(){if(St)return me;St=1;var s=T(),e=L(),t=Ln(),n=Hn();function r(i,o,a,c,h){var u=e.addPath(i,o),f=this;t.call(this,i,a),this.poll=new n(c,u,h),this.poll.on("message",function(v){f.emit("message",v)}),this.poll.once("close",function(v,_){f.poll=null,f.emit("close",v,_),f.close()})}return s(r,t),r.prototype.close=function(){t.prototype.close.call(this),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},me=r,me}var ve,xt;function $(){if(xt)return ve;xt=1;var s=T(),e=L(),t=_n();function n(i){return function(o,a,c){var h={};typeof a=="string"&&(h.headers={"Content-type":"text/plain"});var u=e.addPath(o,"/xhr_send"),f=new i("POST",u,a,h);return f.once("finish",function(v){if(f=null,v!==200&&v!==204)return c(new Error("http status "+v));c()}),function(){f.close(),f=null;var v=new Error("Aborted");v.code=1e3,c(v)}}}function r(i,o,a,c){t.call(this,i,o,n(c),a,c)}return s(r,t),ve=r,ve}var ge,Ct;function re(){if(Ct)return ge;Ct=1;var s=T(),e=A().EventEmitter;function t(n,r){e.call(this);var i=this;this.bufferPosition=0,this.xo=new r("POST",n,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(o,a){i._chunkHandler(o,a),i.xo=null;var c=o===200?"network":"permanent";i.emit("close",null,c),i._cleanup()})}return s(t,e),t.prototype._chunkHandler=function(n,r){if(!(n!==200||!r))for(var i=-1;;this.bufferPosition+=i+1){var o=r.slice(this.bufferPosition);if(i=o.indexOf(`
`),i===-1)break;var a=o.slice(0,i);a&&this.emit("message",a)}},t.prototype._cleanup=function(){this.removeAllListeners()},t.prototype.abort=function(){this.xo&&(this.xo.close(),this.emit("close",null,"user"),this.xo=null),this._cleanup()},ge=t,ge}var be,kt;function En(){if(kt)return be;kt=1;var s=A().EventEmitter,e=T(),t=F(),n=L(),r=window.XMLHttpRequest,i=function(){};function o(h,u,f,v){var _=this;s.call(this),setTimeout(function(){_._start(h,u,f,v)},0)}e(o,s),o.prototype._start=function(h,u,f,v){var _=this;try{this.xhr=new r}catch{}if(!this.xhr){this.emit("finish",0,"no xhr support"),this._cleanup();return}u=n.addQuery(u,"t="+ +new Date),this.unloadRef=t.unloadAdd(function(){_._cleanup(!0)});try{this.xhr.open(h,u,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){i("xhr timeout"),_.emit("finish",0,""),_._cleanup(!1)})}catch{this.emit("finish",0,""),this._cleanup(!1);return}if((!v||!v.noCredentials)&&o.supportsCORS&&(this.xhr.withCredentials=!0),v&&v.headers)for(var C in v.headers)this.xhr.setRequestHeader(C,v.headers[C]);this.xhr.onreadystatechange=function(){if(_.xhr){var x=_.xhr,R,O;switch(i("readyState",x.readyState),x.readyState){case 3:try{O=x.status,R=x.responseText}catch{}O===1223&&(O=204),O===200&&R&&R.length>0&&_.emit("chunk",O,R);break;case 4:O=x.status,O===1223&&(O=204),(O===12005||O===12029)&&(O=0),i("finish",O,x.responseText),_.emit("finish",O,x.responseText),_._cleanup(!1);break}}};try{_.xhr.send(f)}catch{_.emit("finish",0,""),_._cleanup(!1)}},o.prototype._cleanup=function(h){if(this.xhr){if(this.removeAllListeners(),t.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),h)try{this.xhr.abort()}catch{}this.unloadRef=this.xhr=null}},o.prototype.close=function(){this._cleanup(!0)},o.enabled=!!r;var a=["Active"].concat("Object").join("X");!o.enabled&&a in window&&(r=function(){try{return new window[a]("Microsoft.XMLHTTP")}catch{return null}},o.enabled=!!new r);var c=!1;try{c="withCredentials"in new r}catch{}return o.supportsCORS=c,be=o,be}var we,Tt;function ie(){if(Tt)return we;Tt=1;var s=T(),e=En();function t(n,r,i,o){e.call(this,n,r,i,o)}return s(t,e),t.enabled=e.enabled&&e.supportsCORS,we=t,we}var ye,Rt;function J(){if(Rt)return ye;Rt=1;var s=T(),e=En();function t(n,r,i){e.call(this,n,r,i,{noCredentials:!0})}return s(t,e),t.enabled=e.enabled,ye=t,ye}var _e,Ot;function G(){return Ot||(Ot=1,_e={isOpera:function(){return window.navigator&&/opera/i.test(window.navigator.userAgent)},isKonqueror:function(){return window.navigator&&/konqueror/i.test(window.navigator.userAgent)},hasDomain:function(){if(!window.document)return!0;try{return!!window.document.domain}catch{return!1}}}),_e}var Ee,It;function Bn(){if(It)return Ee;It=1;var s=T(),e=$(),t=re(),n=ie(),r=J(),i=G();function o(a){if(!r.enabled&&!n.enabled)throw new Error("Transport created when disabled");e.call(this,a,"/xhr_streaming",t,n)}return s(o,e),o.enabled=function(a){return a.nullOrigin||i.isOpera()?!1:n.enabled},o.transportName="xhr-streaming",o.roundTrips=2,o.needBody=!!window.document,Ee=o,Ee}var Se,Nt;function it(){if(Nt)return Se;Nt=1;var s=A().EventEmitter,e=T(),t=F(),n=G(),r=L(),i=function(){};function o(a,c,h){var u=this;s.call(this),setTimeout(function(){u._start(a,c,h)},0)}return e(o,s),o.prototype._start=function(a,c,h){var u=this,f=new window.XDomainRequest;c=r.addQuery(c,"t="+ +new Date),f.onerror=function(){u._error()},f.ontimeout=function(){u._error()},f.onprogress=function(){i("progress",f.responseText),u.emit("chunk",200,f.responseText)},f.onload=function(){u.emit("finish",200,f.responseText),u._cleanup(!1)},this.xdr=f,this.unloadRef=t.unloadAdd(function(){u._cleanup(!0)});try{this.xdr.open(a,c),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(h)}catch{this._error()}},o.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},o.prototype._cleanup=function(a){if(this.xdr){if(this.removeAllListeners(),t.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,a)try{this.xdr.abort()}catch{}this.unloadRef=this.xdr=null}},o.prototype.close=function(){this._cleanup(!0)},o.enabled=!!(window.XDomainRequest&&n.hasDomain()),Se=o,Se}var xe,qt;function Sn(){if(qt)return xe;qt=1;var s=T(),e=$(),t=re(),n=it();function r(i){if(!n.enabled)throw new Error("Transport created when disabled");e.call(this,i,"/xhr_streaming",t,n)}return s(r,e),r.enabled=function(i){return i.cookie_needed||i.nullOrigin?!1:n.enabled&&i.sameScheme},r.transportName="xdr-streaming",r.roundTrips=2,xe=r,xe}var Ce,jt;function xn(){return jt||(jt=1,Ce=window.EventSource),Ce}var ke,At;function Pn(){if(At)return ke;At=1;var s=T(),e=A().EventEmitter,t=xn(),n=function(){};function r(i){e.call(this);var o=this,a=this.es=new t(i);a.onmessage=function(c){n("message",c.data),o.emit("message",decodeURI(c.data))},a.onerror=function(c){n("error",a.readyState);var h=a.readyState!==2?"network":"permanent";o._cleanup(),o._close(h)}}return s(r,e),r.prototype.abort=function(){this._cleanup(),this._close("user")},r.prototype._cleanup=function(){var i=this.es;i&&(i.onmessage=i.onerror=null,i.close(),this.es=null)},r.prototype._close=function(i){var o=this;setTimeout(function(){o.emit("close",null,i),o.removeAllListeners()},200)},ke=r,ke}var Te,Ut;function Lt(){if(Ut)return Te;Ut=1;var s=T(),e=$(),t=Pn(),n=ie(),r=xn();function i(o){if(!i.enabled())throw new Error("Transport created when disabled");e.call(this,o,"/eventsource",t,n)}return s(i,e),i.enabled=function(){return!!r},i.transportName="eventsource",i.roundTrips=2,Te=i,Te}var Re,Ht;function Cn(){return Ht||(Ht=1,Re="1.6.1"),Re}var Oe={exports:{}},Bt;function z(){return Bt||(Bt=1,function(s){var e=F(),t=G();s.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){s.exports.WPrefix in window||(window[s.exports.WPrefix]={})},postMessage:function(n,r){window.parent!==window&&window.parent.postMessage(JSON.stringify({windowId:s.exports.currentWindowId,type:n,data:r||""}),"*")},createIframe:function(n,r){var i=window.document.createElement("iframe"),o,a,c=function(){clearTimeout(o);try{i.onload=null}catch{}i.onerror=null},h=function(){i&&(c(),setTimeout(function(){i&&i.parentNode.removeChild(i),i=null},0),e.unloadDel(a))},u=function(v){i&&(h(),r(v))},f=function(v,_){setTimeout(function(){try{i&&i.contentWindow&&i.contentWindow.postMessage(v,_)}catch{}},0)};return i.src=n,i.style.display="none",i.style.position="absolute",i.onerror=function(){u("onerror")},i.onload=function(){clearTimeout(o),o=setTimeout(function(){u("onload timeout")},2e3)},window.document.body.appendChild(i),o=setTimeout(function(){u("timeout")},15e3),a=e.unloadAdd(h),{post:f,cleanup:h,loaded:c}},createHtmlfile:function(n,r){var i=["Active"].concat("Object").join("X"),o=new window[i]("htmlfile"),a,c,h,u=function(){clearTimeout(a),h.onerror=null},f=function(){o&&(u(),e.unloadDel(c),h.parentNode.removeChild(h),h=o=null,CollectGarbage())},v=function(x){o&&(f(),r(x))},_=function(x,R){try{setTimeout(function(){h&&h.contentWindow&&h.contentWindow.postMessage(x,R)},0)}catch{}};o.open(),o.write('<html><script>document.domain="'+window.document.domain+'";<\/script></html>'),o.close(),o.parentWindow[s.exports.WPrefix]=window[s.exports.WPrefix];var C=o.createElement("div");return o.body.appendChild(C),h=o.createElement("iframe"),C.appendChild(h),h.src=n,h.onerror=function(){v("onerror")},a=setTimeout(function(){v("timeout")},15e3),c=e.unloadAdd(f),{post:_,cleanup:f,loaded:u}}},s.exports.iframeEnabled=!1,window.document&&(s.exports.iframeEnabled=(typeof window.postMessage=="function"||typeof window.postMessage=="object")&&!t.isKonqueror())}(Oe)),Oe.exports}var Ie,Pt;function kn(){if(Pt)return Ie;Pt=1;var s=T(),e=A().EventEmitter,t=Cn(),n=L(),r=z(),i=F(),o=V(),a=function(){};function c(h,u,f){if(!c.enabled())throw new Error("Transport created when disabled");e.call(this);var v=this;this.origin=n.getOrigin(f),this.baseUrl=f,this.transUrl=u,this.transport=h,this.windowId=o.string(8);var _=n.addPath(f,"/iframe.html")+"#"+this.windowId;this.iframeObj=r.createIframe(_,function(C){v.emit("close",1006,"Unable to load an iframe ("+C+")"),v.close()}),this.onmessageCallback=this._message.bind(this),i.attachEvent("message",this.onmessageCallback)}return s(c,e),c.prototype.close=function(){if(this.removeAllListeners(),this.iframeObj){i.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch{}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},c.prototype._message=function(h){if(a("message",h.data),!n.isOriginEqual(h.origin,this.origin)){a("not same origin",h.origin,this.origin);return}var u;try{u=JSON.parse(h.data)}catch{a("bad json",h.data);return}if(u.windowId!==this.windowId){a("mismatched window id",u.windowId,this.windowId);return}switch(u.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([t,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",u.data);break;case"c":var f;try{f=JSON.parse(u.data)}catch{a("bad json",u.data);return}this.emit("close",f[0],f[1]),this.close();break}},c.prototype.postMessage=function(h,u){this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:h,data:u||""}),this.origin)},c.prototype.send=function(h){this.postMessage("m",h)},c.enabled=function(){return r.iframeEnabled},c.transportName="iframe",c.roundTrips=2,Ie=c,Ie}var Ne,Wt;function st(){return Wt||(Wt=1,Ne={isObject:function(s){var e=typeof s;return e==="function"||e==="object"&&!!s},extend:function(s){if(!this.isObject(s))return s;for(var e,t,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t])}return s}}),Ne}var qe,Dt;function je(){if(Dt)return qe;Dt=1;var s=T(),e=kn(),t=st();return qe=function(n){function r(i,o){e.call(this,n.transportName,i,o)}return s(r,e),r.enabled=function(i,o){if(!window.document)return!1;var a=t.extend({},o);return a.sameOrigin=!0,n.enabled(a)&&e.enabled()},r.transportName="iframe-"+n.transportName,r.needBody=!0,r.roundTrips=e.roundTrips+n.roundTrips-1,r.facadeTransport=n,r},qe}var Ae,Ft;function Wn(){if(Ft)return Ae;Ft=1;var s=T(),e=z(),t=L(),n=A().EventEmitter,r=V(),i=function(){};function o(c){n.call(this);var h=this;e.polluteGlobalNamespace(),this.id="a"+r.string(6),c=t.addQuery(c,"c="+decodeURIComponent(e.WPrefix+"."+this.id)),i("using htmlfile",o.htmlfileEnabled);var u=o.htmlfileEnabled?e.createHtmlfile:e.createIframe;window[e.WPrefix][this.id]={start:function(){h.iframeObj.loaded()},message:function(f){h.emit("message",f)},stop:function(){h._cleanup(),h._close("network")}},this.iframeObj=u(c,function(){h._cleanup(),h._close("permanent")})}s(o,n),o.prototype.abort=function(){this._cleanup(),this._close("user")},o.prototype._cleanup=function(){this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete window[e.WPrefix][this.id]},o.prototype._close=function(c){this.emit("close",null,c),this.removeAllListeners()},o.htmlfileEnabled=!1;var a=["Active"].concat("Object").join("X");if(a in window)try{o.htmlfileEnabled=!!new window[a]("htmlfile")}catch{}return o.enabled=o.htmlfileEnabled||e.iframeEnabled,Ae=o,Ae}var Ue,Mt;function Vt(){if(Mt)return Ue;Mt=1;var s=T(),e=Wn(),t=J(),n=$();function r(i){if(!e.enabled)throw new Error("Transport created when disabled");n.call(this,i,"/htmlfile",e,t)}return s(r,n),r.enabled=function(i){return e.enabled&&i.sameOrigin},r.transportName="htmlfile",r.roundTrips=2,Ue=r,Ue}var Le,$t;function Xt(){if($t)return Le;$t=1;var s=T(),e=$(),t=re(),n=ie(),r=J();function i(o){if(!r.enabled&&!n.enabled)throw new Error("Transport created when disabled");e.call(this,o,"/xhr",t,n)}return s(i,e),i.enabled=function(o){return o.nullOrigin?!1:r.enabled&&o.sameOrigin?!0:n.enabled},i.transportName="xhr-polling",i.roundTrips=2,Le=i,Le}var He,Jt;function Dn(){if(Jt)return He;Jt=1;var s=T(),e=$(),t=Sn(),n=re(),r=it();function i(o){if(!r.enabled)throw new Error("Transport created when disabled");e.call(this,o,"/xhr",n,r)}return s(i,e),i.enabled=t.enabled,i.transportName="xdr-polling",i.roundTrips=2,He=i,He}var Be,Gt;function Fn(){if(Gt)return Be;Gt=1;var s=z(),e=V(),t=G(),n=L(),r=T(),i=A().EventEmitter,o=function(){};function a(c){var h=this;i.call(this),s.polluteGlobalNamespace(),this.id="a"+e.string(6);var u=n.addQuery(c,"c="+encodeURIComponent(s.WPrefix+"."+this.id));window[s.WPrefix][this.id]=this._callback.bind(this),this._createScript(u),this.timeoutId=setTimeout(function(){h._abort(new Error("JSONP script loaded abnormally (timeout)"))},a.timeout)}return r(a,i),a.prototype.abort=function(){if(window[s.WPrefix][this.id]){var c=new Error("JSONP user aborted read");c.code=1e3,this._abort(c)}},a.timeout=35e3,a.scriptErrorTimeout=1e3,a.prototype._callback=function(c){this._cleanup(),!this.aborting&&(c&&this.emit("message",c),this.emit("close",null,"network"),this.removeAllListeners())},a.prototype._abort=function(c){this._cleanup(),this.aborting=!0,this.emit("close",c.code,c.message),this.removeAllListeners()},a.prototype._cleanup=function(){if(clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var c=this.script;c.parentNode.removeChild(c),c.onreadystatechange=c.onerror=c.onload=c.onclick=null,this.script=null}delete window[s.WPrefix][this.id]},a.prototype._scriptError=function(){var c=this;this.errorTimer||(this.errorTimer=setTimeout(function(){c.loadedOkay||c._abort(new Error("JSONP script loaded abnormally (onerror)"))},a.scriptErrorTimeout))},a.prototype._createScript=function(c){var h=this,u=this.script=window.document.createElement("script"),f;if(u.id="a"+e.string(8),u.src=c,u.type="text/javascript",u.charset="UTF-8",u.onerror=this._scriptError.bind(this),u.onload=function(){h._abort(new Error("JSONP script loaded abnormally (onload)"))},u.onreadystatechange=function(){if(o("onreadystatechange",u.readyState),/loaded|closed/.test(u.readyState)){if(u&&u.htmlFor&&u.onclick){h.loadedOkay=!0;try{u.onclick()}catch{}}u&&h._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},typeof u.async>"u"&&window.document.attachEvent)if(t.isOpera())f=this.script2=window.document.createElement("script"),f.text="try{var a = document.getElementById('"+u.id+"'); if(a)a.onerror();}catch(x){};",u.async=f.async=!1;else{try{u.htmlFor=u.id,u.event="onclick"}catch{}u.async=!0}typeof u.async<"u"&&(u.async=!0);var v=window.document.getElementsByTagName("head")[0];v.insertBefore(u,v.firstChild),f&&v.insertBefore(f,v.firstChild)},Be=a,Be}var Pe,zt;function Mn(){if(zt)return Pe;zt=1;var s=V(),e=L(),t=function(){},n,r;function i(a){try{return window.document.createElement('<iframe name="'+a+'">')}catch{var c=window.document.createElement("iframe");return c.name=a,c}}function o(){n=window.document.createElement("form"),n.style.display="none",n.style.position="absolute",n.method="POST",n.enctype="application/x-www-form-urlencoded",n.acceptCharset="UTF-8",r=window.document.createElement("textarea"),r.name="d",n.appendChild(r),window.document.body.appendChild(n)}return Pe=function(a,c,h){n||o();var u="a"+s.string(8);n.target=u,n.action=e.addQuery(e.addPath(a,"/jsonp_send"),"i="+u);var f=i(u);f.id=u,f.style.display="none",n.appendChild(f);try{r.value=c}catch{}n.submit();var v=function(_){f.onerror&&(f.onreadystatechange=f.onerror=f.onload=null,setTimeout(function(){f.parentNode.removeChild(f),f=null},500),r.value="",h(_))};return f.onerror=function(){v()},f.onload=function(){v()},f.onreadystatechange=function(_){t("onreadystatechange",u,f.readyState),f.readyState==="complete"&&v()},function(){v(new Error("Aborted"))}},Pe}var We,Kt;function Vn(){if(Kt)return We;Kt=1;var s=T(),e=_n(),t=Fn(),n=Mn();function r(i){if(!r.enabled())throw new Error("Transport created when disabled");e.call(this,i,"/jsonp",n,t)}return s(r,e),r.enabled=function(){return!!window.document},r.transportName="jsonp-polling",r.roundTrips=1,r.needBody=!0,We=r,We}var De,Qt;function $n(){return Qt||(Qt=1,De=[Un(),Bn(),Sn(),Lt(),je()(Lt()),Vt(),je()(Vt()),Xt(),Dn(),je()(Xt()),Vn()]),De}var Zt={},Yt;function Xn(){if(Yt)return Zt;Yt=1;var s=Array.prototype,e=Object.prototype,t=Function.prototype,n=String.prototype,r=s.slice,i=e.toString,o=function(g){return e.toString.call(g)==="[object Function]"},a=function(d){return i.call(d)==="[object Array]"},c=function(d){return i.call(d)==="[object String]"},h=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch{return!1}}(),u;h?u=function(g,d,w,S){!S&&d in g||Object.defineProperty(g,d,{configurable:!0,enumerable:!1,writable:!0,value:w})}:u=function(g,d,w,S){!S&&d in g||(g[d]=w)};var f=function(g,d,w){for(var S in d)e.hasOwnProperty.call(d,S)&&u(g,S,d[S],w)},v=function(g){if(g==null)throw new TypeError("can't convert "+g+" to object");return Object(g)};function _(g){var d=+g;return d!==d?d=0:d!==0&&d!==1/0&&d!==-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d))),d}function C(g){return g>>>0}function x(){}f(t,{bind:function(d){var w=this;if(!o(w))throw new TypeError("Function.prototype.bind called on incompatible "+w);for(var S=r.call(arguments,1),k=function(){if(this instanceof q){var M=w.apply(this,S.concat(r.call(arguments)));return Object(M)===M?M:this}else return w.apply(d,S.concat(r.call(arguments)))},N=Math.max(0,w.length-S.length),y=[],B=0;B<N;B++)y.push("$"+B);var q=Function("binder","return function ("+y.join(",")+"){ return binder.apply(this, arguments); }")(k);return w.prototype&&(x.prototype=w.prototype,q.prototype=new x,x.prototype=null),q}}),f(Array,{isArray:a});var R=Object("a"),O=R[0]!=="a"||!(0 in R),p=function(d){var w=!0,S=!0;return d&&(d.call("foo",function(k,N,y){typeof y!="object"&&(w=!1)}),d.call([1],function(){S=typeof this=="string"},"x")),!!d&&w&&S};f(s,{forEach:function(d){var w=v(this),S=O&&c(this)?this.split(""):w,k=arguments[1],N=-1,y=S.length>>>0;if(!o(d))throw new TypeError;for(;++N<y;)N in S&&d.call(k,S[N],N,w)}},!p(s.forEach));var b=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;f(s,{indexOf:function(d){var w=O&&c(this)?this.split(""):v(this),S=w.length>>>0;if(!S)return-1;var k=0;for(arguments.length>1&&(k=_(arguments[1])),k=k>=0?k:Math.max(0,S+k);k<S;k++)if(k in w&&w[k]===d)return k;return-1}},b);var l=n.split;"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1?function(){var g=/()??/.exec("")[1]===void 0;n.split=function(d,w){var S=this;if(d===void 0&&w===0)return[];if(i.call(d)!=="[object RegExp]")return l.call(this,d,w);var k=[],N=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.extended?"x":"")+(d.sticky?"y":""),y=0,B,q,M,at;for(d=new RegExp(d.source,N+"g"),S+="",g||(B=new RegExp("^"+d.source+"$(?!\\s)",N)),w=w===void 0?-1>>>0:C(w);(q=d.exec(S))&&(M=q.index+q[0].length,!(M>y&&(k.push(S.slice(y,q.index)),!g&&q.length>1&&q[0].replace(B,function(){for(var K=1;K<arguments.length-2;K++)arguments[K]===void 0&&(q[K]=void 0)}),q.length>1&&q.index<S.length&&s.push.apply(k,q.slice(1)),at=q[0].length,y=M,k.length>=w)));)d.lastIndex===q.index&&d.lastIndex++;return y===S.length?(at||!d.test(""))&&k.push(""):k.push(S.slice(y)),k.length>w?k.slice(0,w):k}}():"0".split(void 0,0).length&&(n.split=function(d,w){return d===void 0&&w===0?[]:l.call(this,d,w)});var m=n.substr,E="".substr&&"0b".substr(-1)!=="b";return f(n,{substr:function(d,w){return m.call(this,d<0&&(d=this.length+d)<0?0:d,w)}},E),Zt}var Fe,en;function Jn(){if(en)return Fe;en=1;var s=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,e,t=function(n){var r,i={},o=[];for(r=0;r<65536;r++)o.push(String.fromCharCode(r));return n.lastIndex=0,o.join("").replace(n,function(a){return i[a]="\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4),""}),n.lastIndex=0,i};return Fe={quote:function(n){var r=JSON.stringify(n);return s.lastIndex=0,s.test(r)?(e||(e=t(s)),r.replace(s,function(i){return e[i]})):r}},Fe}var Me,tn;function Gn(){if(tn)return Me;tn=1;var s=function(){};return Me=function(e){return{filterToEnabled:function(t,n){var r={main:[],facade:[]};return t?typeof t=="string"&&(t=[t]):t=[],e.forEach(function(i){if(i&&!(i.transportName==="websocket"&&n.websocket===!1)){if(t.length&&t.indexOf(i.transportName)===-1){s("not in whitelist",i.transportName);return}i.enabled(n)?(s("enabled",i.transportName),r.main.push(i),i.facadeTransport&&r.facade.push(i.facadeTransport)):s("disabled",i.transportName)}}),r}}},Me}var Ve,nn;function zn(){if(nn)return Ve;nn=1;var s={};return["log","debug","warn"].forEach(function(e){var t;try{t=window.console&&window.console[e]&&window.console[e].apply}catch{}s[e]=t?function(){return window.console[e].apply(window.console,arguments)}:e==="log"?function(){}:s.log}),Ve=s,Ve}var $e,rn;function ot(){if(rn)return $e;rn=1;function s(e){this.type=e}return s.prototype.initEvent=function(e,t,n){return this.type=e,this.bubbles=t,this.cancelable=n,this.timeStamp=+new Date,this},s.prototype.stopPropagation=function(){},s.prototype.preventDefault=function(){},s.CAPTURING_PHASE=1,s.AT_TARGET=2,s.BUBBLING_PHASE=3,$e=s,$e}var Xe,sn;function Tn(){return sn||(sn=1,Xe=window.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}),Xe}var Je,on;function Kn(){if(on)return Je;on=1;var s=T(),e=ot();function t(){e.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}return s(t,e),Je=t,Je}var Ge,an;function Qn(){if(an)return Ge;an=1;var s=T(),e=ot();function t(n){e.call(this),this.initEvent("message",!1,!1),this.data=n}return s(t,e),Ge=t,Ge}var ze,cn;function Zn(){if(cn)return ze;cn=1;var s=A().EventEmitter,e=T();function t(){var n=this;s.call(this),this.to=setTimeout(function(){n.emit("finish",200,"{}")},t.timeout)}return e(t,s),t.prototype.close=function(){clearTimeout(this.to)},t.timeout=2e3,ze=t,ze}var Ke,un;function Rn(){if(un)return Ke;un=1;var s=A().EventEmitter,e=T(),t=st();function n(r,i){s.call(this);var o=this,a=+new Date;this.xo=new i("GET",r),this.xo.once("finish",function(c,h){var u,f;if(c===200){if(f=+new Date-a,h)try{u=JSON.parse(h)}catch{}t.isObject(u)||(u={})}o.emit("finish",u,f),o.removeAllListeners()})}return e(n,s),n.prototype.close=function(){this.removeAllListeners(),this.xo.close()},Ke=n,Ke}var Qe,hn;function On(){if(hn)return Qe;hn=1;var s=T(),e=A().EventEmitter,t=J(),n=Rn();function r(i){var o=this;e.call(this),this.ir=new n(i,t),this.ir.once("finish",function(a,c){o.ir=null,o.emit("message",JSON.stringify([a,c]))})}return s(r,e),r.transportName="iframe-info-receiver",r.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},Qe=r,Qe}var Ze,ln;function Yn(){if(ln)return Ze;ln=1;var s=A().EventEmitter,e=T(),t=F(),n=kn(),r=On();function i(o,a){var c=this;s.call(this);var h=function(){var u=c.ifr=new n(r.transportName,a,o);u.once("message",function(f){if(f){var v;try{v=JSON.parse(f)}catch{c.emit("finish"),c.close();return}var _=v[0],C=v[1];c.emit("finish",_,C)}c.close()}),u.once("close",function(){c.emit("finish"),c.close()})};window.document.body?h():t.attachEvent("load",h)}return e(i,s),i.enabled=function(){return n.enabled()},i.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},Ze=i,Ze}var Ye,dn;function er(){if(dn)return Ye;dn=1;var s=A().EventEmitter,e=T(),t=L(),n=it(),r=ie(),i=J(),o=Zn(),a=Yn(),c=Rn();function h(u,f){var v=this;s.call(this),setTimeout(function(){v.doXhr(u,f)},0)}return e(h,s),h._getReceiver=function(u,f,v){return v.sameOrigin?new c(f,i):r.enabled?new c(f,r):n.enabled&&v.sameScheme?new c(f,n):a.enabled()?new a(u,f):new c(f,o)},h.prototype.doXhr=function(u,f){var v=this,_=t.addPath(u,"/info");this.xo=h._getReceiver(u,_,f),this.timeoutRef=setTimeout(function(){v._cleanup(!1),v.emit("finish")},h.timeout),this.xo.once("finish",function(C,x){v._cleanup(!0),v.emit("finish",C,x)})},h.prototype._cleanup=function(u){clearTimeout(this.timeoutRef),this.timeoutRef=null,!u&&this.xo&&this.xo.close(),this.xo=null},h.prototype.close=function(){this.removeAllListeners(),this._cleanup(!1)},h.timeout=8e3,Ye=h,Ye}var et,fn;function tr(){if(fn)return et;fn=1;var s=z();function e(t){this._transport=t,t.on("message",this._transportMessage.bind(this)),t.on("close",this._transportClose.bind(this))}return e.prototype._transportClose=function(t,n){s.postMessage("c",JSON.stringify([t,n]))},e.prototype._transportMessage=function(t){s.postMessage("t",t)},e.prototype._send=function(t){this._transport.send(t)},e.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},et=e,et}var tt,pn;function nr(){if(pn)return tt;pn=1;var s=L(),e=F(),t=tr(),n=On(),r=z(),i=Tn(),o=function(){};return tt=function(a,c){var h={};c.forEach(function(f){f.facadeTransport&&(h[f.facadeTransport.transportName]=f.facadeTransport)}),h[n.transportName]=n;var u;a.bootstrap_iframe=function(){var f;r.currentWindowId=i.hash.slice(1);var v=function(_){if(_.source===parent&&(typeof u>"u"&&(u=_.origin),_.origin===u)){var C;try{C=JSON.parse(_.data)}catch{o("bad json",_.data);return}if(C.windowId===r.currentWindowId)switch(C.type){case"s":var x;try{x=JSON.parse(C.data)}catch{o("bad json",C.data);break}var R=x[0],O=x[1],p=x[2],b=x[3];if(R!==a.version)throw new Error('Incompatible SockJS! Main site uses: "'+R+'", the iframe: "'+a.version+'".');if(!s.isOriginEqual(p,i.href)||!s.isOriginEqual(b,i.href))throw new Error("Can't connect to different domain from within an iframe. ("+i.href+", "+p+", "+b+")");f=new t(new h[O](p,b));break;case"m":f._send(C.data);break;case"c":f&&f._close(),f=null;break}}};e.attachEvent("message",v),r.postMessage("s")}},tt}var nt,mn;function rr(){if(mn)return nt;mn=1,Xn();var s=wn(),e=T(),t=V(),n=Jn(),r=L(),i=F(),o=Gn(),a=st(),c=G(),h=zn(),u=ot(),f=yn(),v=Tn(),_=Kn(),C=Qn(),x=er(),R=function(){},O;function p(l,m,E){if(!(this instanceof p))return new p(l,m,E);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");f.call(this),this.readyState=p.CONNECTING,this.extensions="",this.protocol="",E=E||{},E.protocols_whitelist&&h.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=E.transports,this._transportOptions=E.transportOptions||{},this._timeout=E.timeout||0;var g=E.sessionId||8;if(typeof g=="function")this._generateSessionId=g;else if(typeof g=="number")this._generateSessionId=function(){return t.string(g)};else throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._server=E.server||t.numberString(1e3);var d=new s(l);if(!d.host||!d.protocol)throw new SyntaxError("The URL '"+l+"' is invalid");if(d.hash)throw new SyntaxError("The URL must not contain a fragment");if(d.protocol!=="http:"&&d.protocol!=="https:")throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+d.protocol+"' is not allowed.");var w=d.protocol==="https:";if(v.protocol==="https:"&&!w&&!r.isLoopbackAddr(d.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");m?Array.isArray(m)||(m=[m]):m=[];var S=m.sort();S.forEach(function(N,y){if(!N)throw new SyntaxError("The protocols entry '"+N+"' is invalid.");if(y<S.length-1&&N===S[y+1])throw new SyntaxError("The protocols entry '"+N+"' is duplicated.")});var k=r.getOrigin(v.href);this._origin=k?k.toLowerCase():null,d.set("pathname",d.pathname.replace(/\/+$/,"")),this.url=d.href,R("using url",this.url),this._urlInfo={nullOrigin:!c.hasDomain(),sameOrigin:r.isOriginEqual(this.url,v.href),sameScheme:r.isSchemeEqual(this.url,v.href)},this._ir=new x(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}e(p,f);function b(l){return l===1e3||l>=3e3&&l<=4999}return p.prototype.close=function(l,m){if(l&&!b(l))throw new Error("InvalidAccessError: Invalid code");if(m&&m.length>123)throw new SyntaxError("reason argument has an invalid length");if(!(this.readyState===p.CLOSING||this.readyState===p.CLOSED)){var E=!0;this._close(l||1e3,m||"Normal closure",E)}},p.prototype.send=function(l){if(typeof l!="string"&&(l=""+l),this.readyState===p.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===p.OPEN&&this._transport.send(n.quote(l))},p.version=Cn(),p.CONNECTING=0,p.OPEN=1,p.CLOSING=2,p.CLOSED=3,p.prototype._receiveInfo=function(l,m){if(this._ir=null,!l){this._close(1002,"Cannot connect to server");return}this._rto=this.countRTO(m),this._transUrl=l.base_url?l.base_url:this.url,l=a.extend(l,this._urlInfo);var E=O.filterToEnabled(this._transportsWhitelist,l);this._transports=E.main,R(this._transports.length+" enabled transports"),this._connect()},p.prototype._connect=function(){for(var l=this._transports.shift();l;l=this._transports.shift()){if(R("attempt",l.transportName),l.needBody&&(!window.document.body||typeof window.document.readyState<"u"&&window.document.readyState!=="complete"&&window.document.readyState!=="interactive")){this._transports.unshift(l),i.attachEvent("load",this._connect.bind(this));return}var m=Math.max(this._timeout,this._rto*l.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),m);var E=r.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),g=this._transportOptions[l.transportName],d=new l(E,this._transUrl,g);d.on("message",this._transportMessage.bind(this)),d.once("close",this._transportClose.bind(this)),d.transportName=l.transportName,this._transport=d;return}this._close(2e3,"All transports failed",!1)},p.prototype._transportTimeout=function(){this.readyState===p.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},p.prototype._transportMessage=function(l){var m=this,E=l.slice(0,1),g=l.slice(1),d;switch(E){case"o":this._open();return;case"h":this.dispatchEvent(new u("heartbeat")),R("heartbeat",this.transport);return}if(g)try{d=JSON.parse(g)}catch{}if(!(typeof d>"u"))switch(E){case"a":Array.isArray(d)&&d.forEach(function(w){R("message",m.transport),m.dispatchEvent(new C(w))});break;case"m":R("message",this.transport),this.dispatchEvent(new C(d));break;case"c":Array.isArray(d)&&d.length===2&&this._close(d[0],d[1],!0);break}},p.prototype._transportClose=function(l,m){if(R("_transportClose",this.transport),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),!b(l)&&l!==2e3&&this.readyState===p.CONNECTING){this._connect();return}this._close(l,m)},p.prototype._open=function(){R("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===p.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=p.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new u("open")),R("connected",this.transport)):this._close(1006,"Server lost session")},p.prototype._close=function(l,m,E){R("_close",this.transport,l,m,E,this.readyState);var g=!1;if(this._ir&&(g=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===p.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=p.CLOSING,setTimeout((function(){this.readyState=p.CLOSED,g&&this.dispatchEvent(new u("error"));var d=new _("close");d.wasClean=E||!1,d.code=l||1e3,d.reason=m,this.dispatchEvent(d),this.onmessage=this.onclose=this.onerror=null}).bind(this),0)},p.prototype.countRTO=function(l){return l>100?4*l:300+l},nt=function(l){return O=o(l),nr()(p,l),p},nt}var rt,vn;function ir(){if(vn)return rt;vn=1;var s=$n();return rt=rr()(s),"_sockjs_onload"in window&&setTimeout(window._sockjs_onload,1),rt}var sr=ir();const or=In(sr),X={LF:`
`,NULL:"\0"};class D{constructor(e){const{command:t,headers:n,body:r,binaryBody:i,escapeHeaderValues:o,skipContentLengthHeader:a}=e;this.command=t,this.headers=Object.assign({},n||{}),i?(this._binaryBody=i,this.isBinaryBody=!0):(this._body=r||"",this.isBinaryBody=!1),this.escapeHeaderValues=o||!1,this.skipContentLengthHeader=a||!1}get body(){return!this._body&&this.isBinaryBody&&(this._body=new TextDecoder().decode(this._binaryBody)),this._body||""}get binaryBody(){return!this._binaryBody&&!this.isBinaryBody&&(this._binaryBody=new TextEncoder().encode(this._body)),this._binaryBody}static fromRawFrame(e,t){const n={},r=i=>i.replace(/^\s+|\s+$/g,"");for(const i of e.headers.reverse()){i.indexOf(":");const o=r(i[0]);let a=r(i[1]);t&&e.command!=="CONNECT"&&e.command!=="CONNECTED"&&(a=D.hdrValueUnEscape(a)),n[o]=a}return new D({command:e.command,headers:n,binaryBody:e.binaryBody,escapeHeaderValues:t})}toString(){return this.serializeCmdAndHeaders()}serialize(){const e=this.serializeCmdAndHeaders();return this.isBinaryBody?D.toUnit8Array(e,this._binaryBody).buffer:e+this._body+X.NULL}serializeCmdAndHeaders(){const e=[this.command];this.skipContentLengthHeader&&delete this.headers["content-length"];for(const t of Object.keys(this.headers||{})){const n=this.headers[t];this.escapeHeaderValues&&this.command!=="CONNECT"&&this.command!=="CONNECTED"?e.push(`${t}:${D.hdrValueEscape(`${n}`)}`):e.push(`${t}:${n}`)}return(this.isBinaryBody||!this.isBodyEmpty()&&!this.skipContentLengthHeader)&&e.push(`content-length:${this.bodyLength()}`),e.join(X.LF)+X.LF+X.LF}isBodyEmpty(){return this.bodyLength()===0}bodyLength(){const e=this.binaryBody;return e?e.length:0}static sizeOfUTF8(e){return e?new TextEncoder().encode(e).length:0}static toUnit8Array(e,t){const n=new TextEncoder().encode(e),r=new Uint8Array([0]),i=new Uint8Array(n.length+t.length+r.length);return i.set(n),i.set(t,n.length),i.set(r,n.length+t.length),i}static marshall(e){return new D(e).serialize()}static hdrValueEscape(e){return e.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")}static hdrValueUnEscape(e){return e.replace(/\\r/g,"\r").replace(/\\n/g,`
`).replace(/\\c/g,":").replace(/\\\\/g,"\\")}}const gn=0,te=10,ne=13,ar=58;class cr{constructor(e,t){this.onFrame=e,this.onIncomingPing=t,this._encoder=new TextEncoder,this._decoder=new TextDecoder,this._token=[],this._initState()}parseChunk(e,t=!1){let n;if(typeof e=="string"?n=this._encoder.encode(e):n=new Uint8Array(e),t&&n[n.length-1]!==0){const r=new Uint8Array(n.length+1);r.set(n,0),r[n.length]=0,n=r}for(let r=0;r<n.length;r++){const i=n[r];this._onByte(i)}}_collectFrame(e){if(e!==gn&&e!==ne){if(e===te){this.onIncomingPing();return}this._onByte=this._collectCommand,this._reinjectByte(e)}}_collectCommand(e){if(e!==ne){if(e===te){this._results.command=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaders;return}this._consumeByte(e)}}_collectHeaders(e){if(e!==ne){if(e===te){this._setupCollectBody();return}this._onByte=this._collectHeaderKey,this._reinjectByte(e)}}_reinjectByte(e){this._onByte(e)}_collectHeaderKey(e){if(e===ar){this._headerKey=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaderValue;return}this._consumeByte(e)}_collectHeaderValue(e){if(e!==ne){if(e===te){this._results.headers.push([this._headerKey,this._consumeTokenAsUTF8()]),this._headerKey=void 0,this._onByte=this._collectHeaders;return}this._consumeByte(e)}}_setupCollectBody(){const e=this._results.headers.filter(t=>t[0]==="content-length")[0];e?(this._bodyBytesRemaining=parseInt(e[1],10),this._onByte=this._collectBodyFixedSize):this._onByte=this._collectBodyNullTerminated}_collectBodyNullTerminated(e){if(e===gn){this._retrievedBody();return}this._consumeByte(e)}_collectBodyFixedSize(e){if(this._bodyBytesRemaining--===0){this._retrievedBody();return}this._consumeByte(e)}_retrievedBody(){this._results.binaryBody=this._consumeTokenAsRaw();try{this.onFrame(this._results)}catch(e){console.log("Ignoring an exception thrown by a frame handler. Original exception: ",e)}this._initState()}_consumeByte(e){this._token.push(e)}_consumeTokenAsUTF8(){return this._decoder.decode(this._consumeTokenAsRaw())}_consumeTokenAsRaw(){const e=new Uint8Array(this._token);return this._token=[],e}_initState(){this._results={command:void 0,headers:[],binaryBody:void 0},this._token=[],this._headerKey=void 0,this._onByte=this._collectFrame}}var P;(function(s){s[s.CONNECTING=0]="CONNECTING",s[s.OPEN=1]="OPEN",s[s.CLOSING=2]="CLOSING",s[s.CLOSED=3]="CLOSED"})(P=P||(P={}));var U;(function(s){s[s.ACTIVE=0]="ACTIVE",s[s.DEACTIVATING=1]="DEACTIVATING",s[s.INACTIVE=2]="INACTIVE"})(U=U||(U={}));class j{constructor(e){this.versions=e}supportedVersions(){return this.versions.join(",")}protocolVersions(){return this.versions.map(e=>`v${e.replace(".","")}.stomp`)}}j.V1_0="1.0";j.V1_1="1.1";j.V1_2="1.2";j.default=new j([j.V1_2,j.V1_1,j.V1_0]);function ur(s,e){s.terminate=function(){const t=()=>{};this.onerror=t,this.onmessage=t,this.onopen=t;const n=new Date,r=Math.random().toString().substring(2,8),i=this.onclose;this.onclose=o=>{const a=new Date().getTime()-n.getTime();e(`Discarded socket (#${r})  closed after ${a}ms, with code/reason: ${o.code}/${o.reason}`)},this.close(),i==null||i.call(s,{code:4001,reason:`Quick discarding socket (#${r}) without waiting for the shutdown sequence.`,wasClean:!1})}}class hr{constructor(e,t,n){this._client=e,this._webSocket=t,this._connected=!1,this._serverFrameHandlers={CONNECTED:r=>{this.debug(`connected to server ${r.headers.server}`),this._connected=!0,this._connectedVersion=r.headers.version,this._connectedVersion===j.V1_2&&(this._escapeHeaderValues=!0),this._setupHeartbeat(r.headers),this.onConnect(r)},MESSAGE:r=>{const i=r.headers.subscription,o=this._subscriptions[i]||this.onUnhandledMessage,a=r,c=this,h=this._connectedVersion===j.V1_2?a.headers.ack:a.headers["message-id"];a.ack=(u={})=>c.ack(h,i,u),a.nack=(u={})=>c.nack(h,i,u),o(a)},RECEIPT:r=>{const i=this._receiptWatchers[r.headers["receipt-id"]];i?(i(r),delete this._receiptWatchers[r.headers["receipt-id"]]):this.onUnhandledReceipt(r)},ERROR:r=>{this.onStompError(r)}},this._counter=0,this._subscriptions={},this._receiptWatchers={},this._partialData="",this._escapeHeaderValues=!1,this._lastServerActivityTS=Date.now(),this.debug=n.debug,this.stompVersions=n.stompVersions,this.connectHeaders=n.connectHeaders,this.disconnectHeaders=n.disconnectHeaders,this.heartbeatIncoming=n.heartbeatIncoming,this.heartbeatOutgoing=n.heartbeatOutgoing,this.splitLargeFrames=n.splitLargeFrames,this.maxWebSocketChunkSize=n.maxWebSocketChunkSize,this.forceBinaryWSFrames=n.forceBinaryWSFrames,this.logRawCommunication=n.logRawCommunication,this.appendMissingNULLonIncoming=n.appendMissingNULLonIncoming,this.discardWebsocketOnCommFailure=n.discardWebsocketOnCommFailure,this.onConnect=n.onConnect,this.onDisconnect=n.onDisconnect,this.onStompError=n.onStompError,this.onWebSocketClose=n.onWebSocketClose,this.onWebSocketError=n.onWebSocketError,this.onUnhandledMessage=n.onUnhandledMessage,this.onUnhandledReceipt=n.onUnhandledReceipt,this.onUnhandledFrame=n.onUnhandledFrame}get connectedVersion(){return this._connectedVersion}get connected(){return this._connected}start(){const e=new cr(t=>{const n=D.fromRawFrame(t,this._escapeHeaderValues);this.logRawCommunication||this.debug(`<<< ${n}`),(this._serverFrameHandlers[n.command]||this.onUnhandledFrame)(n)},()=>{this.debug("<<< PONG")});this._webSocket.onmessage=t=>{if(this.debug("Received data"),this._lastServerActivityTS=Date.now(),this.logRawCommunication){const n=t.data instanceof ArrayBuffer?new TextDecoder().decode(t.data):t.data;this.debug(`<<< ${n}`)}e.parseChunk(t.data,this.appendMissingNULLonIncoming)},this._webSocket.onclose=t=>{this.debug(`Connection closed to ${this._webSocket.url}`),this._cleanUp(),this.onWebSocketClose(t)},this._webSocket.onerror=t=>{this.onWebSocketError(t)},this._webSocket.onopen=()=>{const t=Object.assign({},this.connectHeaders);this.debug("Web Socket Opened..."),t["accept-version"]=this.stompVersions.supportedVersions(),t["heart-beat"]=[this.heartbeatOutgoing,this.heartbeatIncoming].join(","),this._transmit({command:"CONNECT",headers:t})}}_setupHeartbeat(e){if(e.version!==j.V1_1&&e.version!==j.V1_2||!e["heart-beat"])return;const[t,n]=e["heart-beat"].split(",").map(r=>parseInt(r,10));if(this.heartbeatOutgoing!==0&&n!==0){const r=Math.max(this.heartbeatOutgoing,n);this.debug(`send PING every ${r}ms`),this._pinger=setInterval(()=>{this._webSocket.readyState===P.OPEN&&(this._webSocket.send(X.LF),this.debug(">>> PING"))},r)}if(this.heartbeatIncoming!==0&&t!==0){const r=Math.max(this.heartbeatIncoming,t);this.debug(`check PONG every ${r}ms`),this._ponger=setInterval(()=>{const i=Date.now()-this._lastServerActivityTS;i>r*2&&(this.debug(`did not receive server activity for the last ${i}ms`),this._closeOrDiscardWebsocket())},r)}}_closeOrDiscardWebsocket(){this.discardWebsocketOnCommFailure?(this.debug("Discarding websocket, the underlying socket may linger for a while"),this.discardWebsocket()):(this.debug("Issuing close on the websocket"),this._closeWebsocket())}forceDisconnect(){this._webSocket&&(this._webSocket.readyState===P.CONNECTING||this._webSocket.readyState===P.OPEN)&&this._closeOrDiscardWebsocket()}_closeWebsocket(){this._webSocket.onmessage=()=>{},this._webSocket.close()}discardWebsocket(){typeof this._webSocket.terminate!="function"&&ur(this._webSocket,e=>this.debug(e)),this._webSocket.terminate()}_transmit(e){const{command:t,headers:n,body:r,binaryBody:i,skipContentLengthHeader:o}=e,a=new D({command:t,headers:n,body:r,binaryBody:i,escapeHeaderValues:this._escapeHeaderValues,skipContentLengthHeader:o});let c=a.serialize();if(this.logRawCommunication?this.debug(`>>> ${c}`):this.debug(`>>> ${a}`),this.forceBinaryWSFrames&&typeof c=="string"&&(c=new TextEncoder().encode(c)),typeof c!="string"||!this.splitLargeFrames)this._webSocket.send(c);else{let h=c;for(;h.length>0;){const u=h.substring(0,this.maxWebSocketChunkSize);h=h.substring(this.maxWebSocketChunkSize),this._webSocket.send(u),this.debug(`chunk sent = ${u.length}, remaining = ${h.length}`)}}}dispose(){if(this.connected)try{const e=Object.assign({},this.disconnectHeaders);e.receipt||(e.receipt=`close-${this._counter++}`),this.watchForReceipt(e.receipt,t=>{this._closeWebsocket(),this._cleanUp(),this.onDisconnect(t)}),this._transmit({command:"DISCONNECT",headers:e})}catch(e){this.debug(`Ignoring error during disconnect ${e}`)}else(this._webSocket.readyState===P.CONNECTING||this._webSocket.readyState===P.OPEN)&&this._closeWebsocket()}_cleanUp(){this._connected=!1,this._pinger&&(clearInterval(this._pinger),this._pinger=void 0),this._ponger&&(clearInterval(this._ponger),this._ponger=void 0)}publish(e){const{destination:t,headers:n,body:r,binaryBody:i,skipContentLengthHeader:o}=e,a=Object.assign({destination:t},n);this._transmit({command:"SEND",headers:a,body:r,binaryBody:i,skipContentLengthHeader:o})}watchForReceipt(e,t){this._receiptWatchers[e]=t}subscribe(e,t,n={}){n=Object.assign({},n),n.id||(n.id=`sub-${this._counter++}`),n.destination=e,this._subscriptions[n.id]=t,this._transmit({command:"SUBSCRIBE",headers:n});const r=this;return{id:n.id,unsubscribe(i){return r.unsubscribe(n.id,i)}}}unsubscribe(e,t={}){t=Object.assign({},t),delete this._subscriptions[e],t.id=e,this._transmit({command:"UNSUBSCRIBE",headers:t})}begin(e){const t=e||`tx-${this._counter++}`;this._transmit({command:"BEGIN",headers:{transaction:t}});const n=this;return{id:t,commit(){n.commit(t)},abort(){n.abort(t)}}}commit(e){this._transmit({command:"COMMIT",headers:{transaction:e}})}abort(e){this._transmit({command:"ABORT",headers:{transaction:e}})}ack(e,t,n={}){n=Object.assign({},n),this._connectedVersion===j.V1_2?n.id=e:n["message-id"]=e,n.subscription=t,this._transmit({command:"ACK",headers:n})}nack(e,t,n={}){return n=Object.assign({},n),this._connectedVersion===j.V1_2?n.id=e:n["message-id"]=e,n.subscription=t,this._transmit({command:"NACK",headers:n})}}class lr{constructor(e={}){this.stompVersions=j.default,this.connectionTimeout=0,this.reconnectDelay=5e3,this.heartbeatIncoming=1e4,this.heartbeatOutgoing=1e4,this.splitLargeFrames=!1,this.maxWebSocketChunkSize=8*1024,this.forceBinaryWSFrames=!1,this.appendMissingNULLonIncoming=!1,this.discardWebsocketOnCommFailure=!1,this.state=U.INACTIVE;const t=()=>{};this.debug=t,this.beforeConnect=t,this.onConnect=t,this.onDisconnect=t,this.onUnhandledMessage=t,this.onUnhandledReceipt=t,this.onUnhandledFrame=t,this.onStompError=t,this.onWebSocketClose=t,this.onWebSocketError=t,this.logRawCommunication=!1,this.onChangeState=t,this.connectHeaders={},this._disconnectHeaders={},this.configure(e)}get webSocket(){var e;return(e=this._stompHandler)==null?void 0:e._webSocket}get disconnectHeaders(){return this._disconnectHeaders}set disconnectHeaders(e){this._disconnectHeaders=e,this._stompHandler&&(this._stompHandler.disconnectHeaders=this._disconnectHeaders)}get connected(){return!!this._stompHandler&&this._stompHandler.connected}get connectedVersion(){return this._stompHandler?this._stompHandler.connectedVersion:void 0}get active(){return this.state===U.ACTIVE}_changeState(e){this.state=e,this.onChangeState(e)}configure(e){Object.assign(this,e)}activate(){const e=()=>{if(this.active){this.debug("Already ACTIVE, ignoring request to activate");return}this._changeState(U.ACTIVE),this._connect()};this.state===U.DEACTIVATING?(this.debug("Waiting for deactivation to finish before activating"),this.deactivate().then(()=>{e()})):e()}async _connect(){if(await this.beforeConnect(),this._stompHandler){this.debug("There is already a stompHandler, skipping the call to connect");return}if(!this.active){this.debug("Client has been marked inactive, will not attempt to connect");return}this.connectionTimeout>0&&(this._connectionWatcher&&clearTimeout(this._connectionWatcher),this._connectionWatcher=setTimeout(()=>{this.connected||(this.debug(`Connection not established in ${this.connectionTimeout}ms, closing socket`),this.forceDisconnect())},this.connectionTimeout)),this.debug("Opening Web Socket...");const e=this._createWebSocket();this._stompHandler=new hr(this,e,{debug:this.debug,stompVersions:this.stompVersions,connectHeaders:this.connectHeaders,disconnectHeaders:this._disconnectHeaders,heartbeatIncoming:this.heartbeatIncoming,heartbeatOutgoing:this.heartbeatOutgoing,splitLargeFrames:this.splitLargeFrames,maxWebSocketChunkSize:this.maxWebSocketChunkSize,forceBinaryWSFrames:this.forceBinaryWSFrames,logRawCommunication:this.logRawCommunication,appendMissingNULLonIncoming:this.appendMissingNULLonIncoming,discardWebsocketOnCommFailure:this.discardWebsocketOnCommFailure,onConnect:t=>{if(this._connectionWatcher&&(clearTimeout(this._connectionWatcher),this._connectionWatcher=void 0),!this.active){this.debug("STOMP got connected while deactivate was issued, will disconnect now"),this._disposeStompHandler();return}this.onConnect(t)},onDisconnect:t=>{this.onDisconnect(t)},onStompError:t=>{this.onStompError(t)},onWebSocketClose:t=>{this._stompHandler=void 0,this.state===U.DEACTIVATING&&this._changeState(U.INACTIVE),this.onWebSocketClose(t),this.active&&this._schedule_reconnect()},onWebSocketError:t=>{this.onWebSocketError(t)},onUnhandledMessage:t=>{this.onUnhandledMessage(t)},onUnhandledReceipt:t=>{this.onUnhandledReceipt(t)},onUnhandledFrame:t=>{this.onUnhandledFrame(t)}}),this._stompHandler.start()}_createWebSocket(){let e;if(this.webSocketFactory)e=this.webSocketFactory();else if(this.brokerURL)e=new WebSocket(this.brokerURL,this.stompVersions.protocolVersions());else throw new Error("Either brokerURL or webSocketFactory must be provided");return e.binaryType="arraybuffer",e}_schedule_reconnect(){this.reconnectDelay>0&&(this.debug(`STOMP: scheduling reconnection in ${this.reconnectDelay}ms`),this._reconnector=setTimeout(()=>{this._connect()},this.reconnectDelay))}async deactivate(e={}){var i;const t=e.force||!1,n=this.active;let r;if(this.state===U.INACTIVE)return this.debug("Already INACTIVE, nothing more to do"),Promise.resolve();if(this._changeState(U.DEACTIVATING),this._reconnector&&(clearTimeout(this._reconnector),this._reconnector=void 0),this._stompHandler&&this.webSocket.readyState!==P.CLOSED){const o=this._stompHandler.onWebSocketClose;r=new Promise((a,c)=>{this._stompHandler.onWebSocketClose=h=>{o(h),a()}})}else return this._changeState(U.INACTIVE),Promise.resolve();return t?(i=this._stompHandler)==null||i.discardWebsocket():n&&this._disposeStompHandler(),r}forceDisconnect(){this._stompHandler&&this._stompHandler.forceDisconnect()}_disposeStompHandler(){this._stompHandler&&this._stompHandler.dispose()}publish(e){this._checkConnection(),this._stompHandler.publish(e)}_checkConnection(){if(!this.connected)throw new TypeError("There is no underlying STOMP connection")}watchForReceipt(e,t){this._checkConnection(),this._stompHandler.watchForReceipt(e,t)}subscribe(e,t,n={}){return this._checkConnection(),this._stompHandler.subscribe(e,t,n)}unsubscribe(e,t={}){this._checkConnection(),this._stompHandler.unsubscribe(e,t)}begin(e){return this._checkConnection(),this._stompHandler.begin(e)}commit(e){this._checkConnection(),this._stompHandler.commit(e)}abort(e){this._checkConnection(),this._stompHandler.abort(e)}ack(e,t,n={}){this._checkConnection(),this._stompHandler.ack(e,t,n)}nack(e,t,n={}){this._checkConnection(),this._stompHandler.nack(e,t,n)}}function dr(){const[s,e]=H.useState(null),[t,n]=H.useState([]),[r,i]=H.useState([]);H.useEffect(()=>{const c=new lr({webSocketFactory:()=>new or("https://www.stocktide.store/ws-stocktide"),heartbeatIncoming:4e3,heartbeatOutgoing:4e3,reconnectDelay:5e3,debug:h=>{console.log(h)},onConnect:()=>{console.log("WebSocket Connected"),c.connected&&(c.subscribe("/topic/users",h=>{const u=JSON.parse(h.body);console.log("Users update received:",u),i(u.connectedUsers),u.type==="CONNECTED"?ct.info(`${u.username} joined the chat`):u.type==="DISCONNECTED"&&ct.info(`${u.username} left the chat`)}),c.subscribe("/topic/public",h=>{const u=JSON.parse(h.body);n(f=>[...f,u])}))},onDisconnect:()=>{console.log("WebSocket Disconnected")},onStompError:h=>{console.error("STOMP error:",h)}});e(c);try{c.activate()}catch(h){console.error("Failed to connect:",h)}return()=>{c.deactivate().then()}},[]);const o=H.useCallback(c=>{if(s&&s.connected&&c.type==="CHAT")try{s.publish({destination:"/app/chat.sendMessage",body:JSON.stringify(c)})}catch(h){console.error("Failed to send message:",h)}},[s]),a=H.useCallback(c=>{s&&s.connected&&c.type==="JOIN"&&s.publish({destination:"/app/chat.addUser",body:JSON.stringify(c)})},[s]);return{stompClient:s,messages:t,connectedUsers:r,sendMessage:o,addUser:a}}const bn=W.div`
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
    height: 100vh;
    display: flex;
    flex-direction: column;
`,fr=W.div`
`,pr=W.div`
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    background: #f5f5f5;
    border-radius: 8px;
    margin-bottom: 20px;
`,mr=W.div`
    display: flex;
    justify-content: ${s=>s.$isCurrentUser?"flex-end":"flex-start"};
    margin-bottom: 10px;
`,vr=W.div`
    background: white;
    padding: 10px 15px;
    border-radius: 8px;
    max-width: 70%;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
`,gr=W.div`
    font-weight: bold;
    font-size: 0.9em;
    color: #666;
`,br=W.div`
    margin: 5px 0;
    word-break: break-word; // 긴 메시지 처리
    color: #333;           // 메시지 텍스트 색상
    font-size: 1rem;      // 메시지 텍스트 크기
    line-height: 1.5;     // 줄 간격
`,wr=W.div`
    font-size: 0.8em;
    color: #999;
`,yr=W.div`
    display: flex;
    gap: 10px;

    input {
        flex: 1;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
    }

    button {
        padding: 10px 20px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;

        &:hover {
            background: #0056b3;
        }
    }
`,_r=()=>{const s=H.useRef(null),[e,t]=H.useState(""),[n,r]=H.useState(""),[i,o]=H.useState(!1),{messages:a,connectedUsers:c,sendMessage:h,addUser:u}=dr();H.useEffect(()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},[a]);const f=_=>{if(_.preventDefault(),e.trim()){const C={type:"JOIN",content:`${e} joined the chat`,sender:e,time:new Date().toLocaleTimeString()};u(C),o(!0)}},v=_=>{if(_.preventDefault(),n.trim()){const C={type:"CHAT",content:n,sender:e,time:new Date().toLocaleTimeString()};h(C),r("")}};return I.jsx(bn,{children:i?I.jsxs(I.Fragment,{children:[I.jsxs(fr,{children:[I.jsxs("h3",{children:["Connected Users (",c.length,")"]}),I.jsx("ul",{children:c.map((_,C)=>I.jsx("li",{children:_},C))})]}),I.jsx(pr,{ref:s,children:a.map((_,C)=>I.jsx(mr,{$isCurrentUser:_.sender===e,children:I.jsxs(vr,{children:[I.jsx(gr,{children:_.sender}),I.jsx(br,{children:_.content||"(no content)"}),I.jsx(wr,{children:_.time})]})},C))}),I.jsx("form",{onSubmit:v,children:I.jsxs(yr,{children:[I.jsx("input",{type:"text",placeholder:"Type a message...",value:n,onChange:_=>r(_.target.value)}),I.jsx("button",{type:"submit",children:"Send"})]})})]}):I.jsx(bn,{children:I.jsxs("form",{onSubmit:f,children:[I.jsx("input",{type:"text",placeholder:"Enter your username",value:e,onChange:_=>t(_.target.value)}),I.jsx("button",{type:"submit",children:"Join Chat"})]})})})};function kr(){return I.jsx(_r,{})}export{kr as default};
//# sourceMappingURL=Chat-CZBgUqMQ.js.map
